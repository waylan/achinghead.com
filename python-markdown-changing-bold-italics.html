<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Python-Markdown Tutorial Part 2: Changing Bold and Italics - achinghead.com</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://achinghead.com/python-markdown-changing-bold-italics.html">

        <meta name="author" content="Waylan Limberg" />
        <meta name="keywords" content="markdown,python" />
        <meta name="description" content="Part 2 in a series of tutorials which step through creating a simple Python-Markdown Extension that slightly alters the Markdown syntax. Specifically, in this part, we redefine the “bold” and “italics” syntax, overriding the parsers current behavior." />

    <!-- Enable latex plugin -->




    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://achinghead.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://achinghead.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://achinghead.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://achinghead.com/theme/css/style.css" type="text/css"/>

        <link href="http://achinghead.com/atom.xml" type="application/atom+xml" rel="alternate"
              title="achinghead.com ATOM Feed"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://achinghead.com/" class="navbar-brand">
achinghead.com            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://achinghead.com/pages/about.html">
                             About
                          </a></li>
                         <li><a href="http://achinghead.com/pages/projects.html">
                             Projects
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://achinghead.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://achinghead.com/python-markdown-changing-bold-italics.html"
                       rel="bookmark"
                       title="Permalink to Python-Markdown Tutorial Part 2: Changing Bold and Italics">
                        Python-Markdown Tutorial Part 2: Changing Bold and Italics
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2009-07-12T00:00:00-04:00"> July 12, 2009</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="http://achinghead.com/tag/markdown.html">markdown</a>
        /
	<a href="http://achinghead.com/tag/python.html">python</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>In <a href="/python-markdown-adding-insert-delete.html">part 1</a>, we created a Python-Markdown extension which implements a new 
syntax for defining <code>&lt;ins&gt;</code> and <code>&lt;del&gt;</code> tags. Now we need to alter Markdown&rsquo;s 
existing syntax for bold and italics. As a reminder, your new syntax should 
look like this:</p>
<div class="highlight"><pre>Two hyphens for --delete--.
Two underscores for __insert__.
Two asterisks for **strong**.
Two slashes for //emphasis//.
</pre></div>


<p>First, we need to define our new regular expressions. We can just use the same
expressions from last time with a few modifications.</p>
<div class="highlight"><pre><span class="n">STRONG_RE</span> <span class="o">=</span> <span class="s">r&#39;(\*\*)(.*?)\*\*&#39;</span>
<span class="n">EMPH_RE</span> <span class="o">=</span> <span class="s">r&#39;(\/\/)(.*?)\/\/&#39;</span>
</pre></div>


<p>Now we need to insert these into the markdown parser. However, unlike with ins and del, we need to override the existing inline patterns. A quick look at the
<a href="http://gitorious.org/python-markdown/mainline/blobs/master/markdown/__init__.py#line276">source</a> indicates that strong and emphasis are currently implemented with 
four inline patterns; &ldquo;strong&rdquo;, &ldquo;emphasis&rdquo;, &ldquo;emphasis2&rdquo; and &ldquo;strong_em&rdquo;.</p>
<p>Let&rsquo;s override &ldquo;strong&rdquo; first.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">markdown</span><span class="o">.</span><span class="n">Extension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extendMarkdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">md_globals</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="c"># Create new strong pattern</span>
        <span class="n">strong_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">STRONG_RE</span><span class="p">,</span> <span class="s">&#39;strong&#39;</span><span class="p">)</span>
        <span class="c"># Override existing strong pattern</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;strong&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strong_tag</span>
</pre></div>


<p>Notice that rather than &ldquo;add&rdquo;ing a new pattern before or after an existing 
pattern, we simple reassigned the value of a pattern named &ldquo;strong&rdquo;. This is
because the old pattern named &ldquo;strong&rdquo; already existed and we don&rsquo;t need to 
change its location in the parser. So we simply assign a new pattern instance 
to it.</p>
<p>We can do the same for emphasis:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">markdown</span><span class="o">.</span><span class="n">Extension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extendMarkdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">md_globals</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="n">emph_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">EMPH_RE</span><span class="p">,</span> <span class="s">&#39;emphasis&#39;</span><span class="p">)</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;emphasis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emph_tag</span>
</pre></div>


<p>Now we have two old patterns left, &ldquo;strong_em&rdquo; and &ldquo;emphasis2&rdquo;. &ldquo;Emphasis2&rdquo;
was just a special case so that underscored_words were not mistaken for 
emphasis, but as our new syntax required double underscores, it&rsquo;s not needed any
more. Therefore, we can delete it. The same applies for strong_em. With the old 
syntax, due to both strong and emphasis using the same characters, a special 
case was needed to match the two nested together (i.e.: <code>***like this***</code>). 
Again this isn&rsquo;t needed. We can delete the two in the same way we would delete 
dict items:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">markdown</span><span class="o">.</span><span class="n">Extension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extendMarkdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">md_globals</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">del</span> <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;strong_em&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;emphasis2&#39;</span><span class="p">]</span>
</pre></div>


<p>That should do it. For completeness, the entire extension should look like this:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">markdown</span>

<span class="n">DEL_RE</span> <span class="o">=</span> <span class="s">r&#39;(--)(.*?)--&#39;</span>
<span class="n">INS_RE</span> <span class="o">=</span> <span class="s">r&#39;(__)(.*?)__&#39;</span>
<span class="n">STRONG_RE</span> <span class="o">=</span> <span class="s">r&#39;(\*\*)(.*?)\*\*&#39;</span>
<span class="n">EMPH_RE</span> <span class="o">=</span> <span class="s">r&#39;(\/\/)(.*?)\/\/&#39;</span>

<span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">markdown</span><span class="o">.</span><span class="n">Extension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extendMarkdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">md_globals</span><span class="p">):</span>
        <span class="n">del_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">DEL_RE</span><span class="p">,</span> <span class="s">&#39;del&#39;</span><span class="p">)</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;del&#39;</span><span class="p">,</span> <span class="n">del_tag</span><span class="p">,</span> <span class="s">&#39;&gt;not_strong&#39;</span><span class="p">)</span>
        <span class="n">ins_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">INS_RE</span><span class="p">,</span> <span class="s">&#39;ins&#39;</span><span class="p">)</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;ins&#39;</span><span class="p">,</span> <span class="n">ins_tag</span><span class="p">,</span> <span class="s">&#39;&gt;del&#39;</span><span class="p">)</span>
        <span class="n">strong_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">STRONG_RE</span><span class="p">,</span> <span class="s">&#39;strong&#39;</span><span class="p">)</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;strong&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strong_tag</span>
        <span class="n">emph_tag</span> <span class="o">=</span> <span class="n">markdown</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="o">.</span><span class="n">SimpleTagPattern</span><span class="p">(</span><span class="n">EMPH_RE</span><span class="p">,</span> <span class="s">&#39;emphasis&#39;</span><span class="p">)</span>
        <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;emphasis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">emph_tag</span>
        <span class="k">del</span> <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;strong_em&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">md</span><span class="o">.</span><span class="n">inlinepatterns</span><span class="p">[</span><span class="s">&#39;emphasis2&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">makeExtension</span><span class="p">(</span><span class="n">configs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">MyExtension</span><span class="p">(</span><span class="n">configs</span><span class="o">=</span><span class="n">configs</span><span class="p">)</span>
</pre></div>


<p>In part 3 (coming soon) we&rsquo;ll combine all four of those patterns into one new
pattern. Yes, that means we&rsquo;ll be writing our own InlinePattern class.</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">



                <li class="list-group-item"><a href="http://achinghead.com/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-1">
                            <a href="http://achinghead.com/tag/markdown.html">
                                markdown
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://achinghead.com/tag/python.html">
                                python
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://achinghead.com/tag/linux.html">
                                linux
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://achinghead.com/tag/ubuntu.html">
                                Ubuntu
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://achinghead.com/tag/django.html">
                                django
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://achinghead.com/tag/virtualbox.html">
                                VirtualBox
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://achinghead.com/tag/syntax-highlighting.html">
                                syntax highlighting
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://achinghead.com/tag/prostetics.html">
                                prostetics
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://achinghead.com/tag/clipless-glove.html">
                                Clipless Glove
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://achinghead.com/tag/html.html">
                                html
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://achinghead.com/tag/bicycles.html">
                                bicycles
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/hardware.html">
                                hardware
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/git.html">
                                git
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/automobile.html">
                                automobile
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/testing.html">
                                testing
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/electronics.html">
                                electronics
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/python-nose.html">
                                Python Nose
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/hacks.html">
                                hacks
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/anti-spam.html">
                                anti-spam
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://achinghead.com/tag/css.html">
                                css
                            </a>
                        </li>
                    </ul>
                </li>    



        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Waylan Limberg
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://achinghead.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://achinghead.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://achinghead.com/theme/js/respond.min.js"></script>

</body>
</html>